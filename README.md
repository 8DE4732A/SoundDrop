# 🔊 SoundDrop

通过声音传输文件的 Web 应用，使用 [quiet-js](https://github.com/quiet/quiet-js) 实现面对面的文件传输。

## ✨ 特性

- 📁 支持任意文件类型传输
- 📏 最大支持 100KB 文件
- 🎵 使用声音作为传输媒介
- 🔒 本地传输，无需网络连接
- 📱 跨平台支持（手机、电脑）
- 🎨 简洁美观的用户界面

## 🚀 快速开始

### 1. 启动服务器

```bash
cd SoundDrop
python3 server.py
```

服务器将在 `http://localhost:8000` 启动。

### 2. 打开应用

在浏览器中访问：
```
http://localhost:8000/index.html
```

### 3. 传输文件

#### 发送端：
1. 切换到"发送文件"标签
2. 点击选择文件（最大 100KB）
3. 查看文件信息确认无误
4. 点击"开始传输"按钮

#### 接收端：
1. 切换到"接收文件"标签
2. 允许浏览器使用麦克风权限
3. 等待接收文件
4. 接收完成后点击"下载文件"

## 💡 使用技巧

### 最佳实践

- **距离**：两台设备保持 0.5-2 米距离
- **音量**：发送端音量设置为 50-70%
- **环境**：在安静的环境中使用，避免噪音干扰
- **设备**：使用带有较好扬声器和麦克风的设备
- **浏览器**：推荐使用 Chrome、Edge 或 Safari

### 注意事项

- ⚠️ 首次使用需要允许麦克风权限
- ⚠️ 传输过程中保持安静，避免移动设备
- ⚠️ 文件越大传输时间越长（100KB 约需 1-2 分钟）
- ⚠️ 某些浏览器可能不支持（需要 Web Audio API）

## 📂 项目结构

```
SoundDrop/
├── index.html              # 主页面
├── style.css               # 样式文件
├── app.js                  # 核心逻辑
├── server.py               # 本地 HTTP 服务器
├── README.md               # 项目说明
└── example/                # quiet-js 库文件
    ├── quiet.js
    ├── quiet-emscripten.js
    ├── quiet-emscripten.js.mem
    └── quiet-profiles.json
```

## 🔧 技术原理

### 传输流程

```
发送端                          接收端
  │                              │
  ├─ 1. 选择文件                 │
  ├─ 2. 文件分块 (4KB/块)        │
  ├─ 3. 发送元数据包 ─────────> ├─ 接收元数据
  ├─ 4. 发送数据包 #1 ───────> ├─ 接收并缓存
  ├─ 5. 发送数据包 #2 ───────> ├─ 接收并缓存
  │      ...                     │      ...
  ├─ N. 发送数据包 #N ───────> ├─ 接收并缓存
  ├─ N+1. 发送结束标记 ───────> ├─ 重组文件
  │                              ├─ 显示下载按钮
```

### 数据包类型

1. **元数据包 (METADATA)**
   - 文件名
   - 文件类型 (MIME type)
   - 文件大小
   - 数据块总数

2. **数据包 (DATA)**
   - 数据块索引
   - 实际文件数据（最大 4KB）

3. **结束包 (END)**
   - 标记传输完成

### 关键技术

- **quiet-js**：基于 FSK/GMSK 调制的超声波/音频通信库
- **Web Audio API**：浏览器音频处理
- **ArrayBuffer**：高效的二进制数据处理
- **File API**：文件读取和下载

## 🌐 浏览器兼容性

| 浏览器 | 支持 | 备注 |
|--------|------|------|
| Chrome 58+ | ✅ | 推荐使用 |
| Edge 79+ | ✅ | 推荐使用 |
| Safari 14+ | ✅ | 需要允许麦克风权限 |
| Firefox 52+ | ⚠️ | 部分功能可能受限 |
| 移动浏览器 | ✅ | iOS Safari、Chrome Android |

## 📊 性能参数

| 参数 | 值 |
|------|-----|
| 最大文件大小 | 100 KB |
| 数据块大小 | 4 KB |
| 传输协议 | audible (可听频段) |
| 典型传输速率 | ~1 KB/s |
| 传输距离 | 0.5-2 米 |

## 🛠️ 开发

### 修改传输配置

编辑 `app.js` 中的常量：

```javascript
const MAX_FILE_SIZE = 100 * 1024;  // 最大文件大小
const CHUNK_SIZE = 4096;            // 数据块大小
```

### 更改音频配置

修改 `index.html` 中的 profile：

```html
<div class="hidden" data-quiet-profile-name="audible"></div>
```

可选的 profile：
- `audible`：可听频段（默认）
- `ultrasonic`：超声波频段（需要设备支持）

## 📝 许可证

本项目使用 MIT 许可证。

## 🙏 致谢

- [quiet-js](https://github.com/quiet/quiet-js) - 音频数据传输库
- [libquiet](https://github.com/quiet/quiet) - 底层传输协议

## 📮 反馈

如有问题或建议，欢迎提出 Issue。

---

**注意**：本项目仅供学习和演示使用，不建议用于传输敏感或重要文件。
